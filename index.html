<!DOCTYPE html>
<html lang="ru">

<head>
  <title>Web worker</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="shower/themes/ribbon/styles/styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
  <style>
    .shower {
      --slide-ratio: calc(16 / 9);
    }
    .visually-hidden {
      position: absolute;
      clip: rect(0 0 0 0);
    }
  </style>
</head>

<body class="shower list">
  <header class="caption">
    <h1>Как построить дом, если ты — веб-воркер</h1>
    <p>Кирилл Чугаинов, iTechArt</p>
  </header>

  <section class="slide clear" id="cover">
    <h2 class="shout">Как построить дом,<br> если ты — веб-воркер?</h2>
    <figure>
      <img class="cover" src="pictures/wall.jpg" alt="Обложка доклада">
    </figure>
    <style>
      #cover h2 {
        background-color: black;
        color: white;
        font-size: 75px;
        padding: .2em;
      }
    </style>
  </section>

  <section class="slide clear">
    <h2 style="margin-left: 350px;">Кирилл Чугаинов</h2>
    <ul style="margin-left: 400px;">
      <li>Веб-разработчик в iTechArt</li>
      <img src="pictures/kirill_edited.jpg" alt="Фотография спикера" class="place left cover height z-top">
    </ul>
  </section>

  <section class="slide clear" id="podcast">
    <figure>
      <img class="cover place top" src="pictures/podcast.PNG" alt="Скриншот подкаста Frontend weekend">
    </figure>
    <h2 class="place bottom height z-top">11:03</h2>
    <style>
      #podcast h2 {
        background-color: black;
        color: white;
        font-size: 75px;
        padding: .2em;
      }
    </style>
  </section>

  <section class="slide">
    <h2 class="shout">???</h2>
  </section>

  <section class="slide clear">
    <figure>
      <img class="cover" src="pictures/developers.png" alt="Мем 'кто мы?'">
    </figure>
  </section>

  <section class="slide clear">
    <figure>
      <img class="cover" src="pictures/fast sites.png" alt="Мем 'кто мы?'">
    </figure>
  </section>

  <section class="slide clear" style="background-color: black; ">
    <video src="./pictures/load without block.mp4" loop="loop" class="cover height" autoplay="" muted="" playsinline=""></video>    
  </section>
  
  <section class="slide clear">
    <figure>
      <img class="cover" height="100%" width="auto" src="pictures/garold.png" alt="Типичный дизайнер">
    </figure>
  </section>

  <section class="slide clear" style="background-color: black; ">
    <video src="./pictures/load with blocker.mp4" loop="loop" class="cover height" autoplay="" muted="" playsinline=""></video>    
  </section>

  <section class="slide">
    <h2 class="shout" style="font-size: 100px;">Браузер работает<br> в один поток</h2>
  </section>

  <section class="slide">
    <h2>Конвеер рендера</h2>
    <figure>
      <img class="place center" src="pictures/render.png" alt="Схема рендеринга в браузере">
    </figure>
  </section>

  <section class="slide">
    <h2>Конвеер рендера</h2>
    <figure>
      <img class="place center" src="pictures/render with JS.png" alt="Схема рендеринга в браузере и JS">
    </figure>
  </section>

  <section class="slide">
    <h2>Один поток</h2>
    <figure>
      <img width="800" height="auto" class="place center bottom" src="pictures/one thread.png" alt="Один поток">
    </figure>
  </section>

  <section class="slide">
    <h2>Один поток</h2>
    <figure>
      <img width="800" height="auto" class="place center bottom" src="pictures/one thread long js.png" alt="Один поток">
    </figure>
  </section>

  <section class="slide clear" id="ivan">
    <figure>
      <img class="cover" src="pictures/иван тулуп.jpg" alt="Доклад иван тулуп">
    </figure>
    <a href="https://youtu.be/bUx8wk4LdoY" class="copyright right" >Михаил Башуров. Иван Тулуп: асинхронщина в JS под капотом / Frontend Conf 2018</a>
  </section>

  <section class="slide clear" style="background-color: black; ">
    <video src="./pictures/facebook.mp4" class="cover height" autoplay="" muted="" playsinline=""></video>
  </section>
  
  <section class="slide">
    <h2>Отдельный поток</h2>
    <figure>
      <img width="800" height="auto" class="place center bottom" src="pictures/worker thread.png" alt="Вынос логики в другой поток">
    </figure>
  </section>

  <section class="slide clear">
    <h2>Веб-работяга</h2>
    <ul style="margin-right: 300px;">
      <li class="next">Работы любой сложности</li>
      <li class="next">Легко сотрудничать</li>
    </ul>
    <img src="pictures/веб-работяга.jpg" alt="Фотография рабочего" class="place right cover height z-top">
  </section>

  <section class="slide">
    <h2>Внутри кода</h2>
    <pre>
      <code>const myWorker = new Worker(<mark>'worker.js'</mark>);</code>
      <code>...</code>
      <code>myWorker.postMessage(args);</code>
      <code>...</code>
      <code>myWorker.addEventListener('message', (e) => {<mark>...</mark>}, false);</code>
    </pre>
  </section>
  
  <section class="slide">
    <h2>Внутри файла работяги</h2>
    <pre>
      <code>self.addEventListener('message', function(e) {</code>
      <code>...</code>
      <code>self.postMessage(result);</code>
      <code>...</code>
      <code>}, false);</code>
    </pre>
  </section>

  <section class="slide clear" style="background-color: black; ">
    <video src="./pictures/load without block with stats.mp4" class="cover height" loop="loop" autoplay="" muted="" playsinline=""></video>    
  </section>

  <section class="slide clear">
    <h2>Веб-работяга</h2>
    <ul style="margin-right: 300px;">
      <li>Работы любой сложности</li>
      <li>Легко сотрудничать</li>
      <li>Работает в самых тяжёлых условиях</li>
    </ul>
    <img src="pictures/веб-работяга.jpg" alt="Фотография рабочего" class="place right cover height z-top">
  </section>

  <section class="slide clear" id="canIUse">
    <figure>
      <img class="cover" src="pictures/can i use.PNG" alt="Скриншот can i use с очень хорошей поддержкой">
    </figure>
    <style>
      #canIUse {
        background-color: #F2E8D5;
      }
    </style>
  </section>
  
  <section class="slide">
    <h2 class='shout' style="font-size: 100px;">Потокобезопасность</h2>
  </section>
  
  <section class="slide">
    <h2>Потокобезопасность</h2>
    <figure>
      <img width="800" height="auto" class="place center bottom" src="pictures/threadsafety.png" alt="Схема влияния двух потоков на один объект">
    </figure>
  </section>

  <section class="slide clear">
    <figure>
      <img class="cover" src="pictures/LRSH.jpg" alt="Лебедь рак и щука тянут воз">
    </figure>
  </section>

  <section class="slide" id="PM1">
    <h2 class='shout' style="font-size: 80px;">postMessage(msg);</h2>
  </section>

  <section class="slide" id="PM2">
    <h2 class='shout' style="font-size: 80px;">postMessage(msg, [transfer]);</h2>
  </section>

  <section class="slide">
    <h2 class='shout' style="font-size: 80px;">DOM не потокобезопасен</h2>
  </section>

  <section class="slide">
    <h2 class='shout' style="font-size: 100px;">Веб-работяга не может взаимодействовать с DOM</h2>
  </section>

  <section class="slide">
    <h2 class='shout'>vDOM</h2>
  </section>

  <section class="slide">
    <h2>Решения</h2>
    <ol>
      <li><a href="https://medium.com/@azizhk/building-an-async-react-renderer-with-diffing-in-web-worker-f3be07f16d90">Building an async react renderer with diffing in web worker</a></li>
      <li><a href="https://github.com/developit/preact-worker-demo/blob/master/src/renderer/dom.js">Preact worker demo</a></li>
      <li><a href="https://github.com/ampproject/worker-dom">Worker dom</a></li>
      <li><a href="https://github.com/developit/preact-www">Preact-www</a></li>
      <li><a href="https://github.com/theefer/virtualdom-in-web-worker">Virtualdom-in-web-worker</a></li>
    </ol>
  </section>

  <section class="slide clear">
    <video src="./pictures/diff.mp4" class="cover height" autoplay="" loop="loop" muted="" playsinline=""></video>
  </section>

  <section class="slide">
    <h2 class='shout' style="font-size: 100px;">Где используется?</h2>
  </section>

  <section class="slide clear">
    <a href="https://www.smashingmagazine.com/2019/04/webassembly-speed-web-app/" class="copyright right">www.smashingmagazine.com/2019/04/webassembly-speed-web-app/</a>
    <figure>
      <img class="cover" src="pictures/fastq.bio.png" alt="Пример работы fastq.bio">
    </figure>
  </section>
  
  <section class="slide clear" style="background-color: #EAEDEE;">
    <a href="https://www.smashingmagazine.com/2019/04/webassembly-speed-web-app/" class="copyright right">www.smashingmagazine.com/2019/04/webassembly-speed-web-app/</a>
    <figure>
      <img class="cover" src="pictures/webassembly-speed-web-app.png" alt="Схема работы">
    </figure>
  </section>

  <section class="slide">
    <h2 class='shout' style="font-size: 100px;">Прогрессивно улучшайте!</h2>
  </section>

  <section class="slide">
    <h2>Прогрессивно улучшайте!</h2>
    <pre>
      <code>if (<mark>window.Worker</mark>) { </code>
      <code>  const myWorker = new Worker('worker.js');</code>
      <code>};</code>
    </pre>
  </section>

  <section class="slide">
    <div class="place">
      <blockquote class="twitter-tweet" data-lang="ru">
        <p lang="en" dir="ltr">
          We believe getting your JavaScript off the main thread is critical to achieving good performance 💪
          <br><br>
          But `postMessage` is annoying...? 
          Don&#39;t worry, Comlink makes you forget about  postMessage so you can enjoy using Web Workers🌈
          <a href="https://t.co/fYPYg3jKHS">https://t.co/fYPYg3jKHS</a>
        </p>&mdash; Chrome Developers (@ChromiumDev)
        <a href="https://twitter.com/ChromiumDev/status/1126700891585880064?ref_src=twsrc%5Etfw">10 мая 2019 г.</a>
      </blockquote>
    </div>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </section>

  <section class="slide">
    <h2>Полезные ссылки</h2>
    <ol>
      <li><a href="https://www.youtube.com/watch?v=-9NavsFidOA">Немного о worker’аx​ | Технострим</a></li>
      <li><a href="https://habr.com/ru/company/ruvds/blog/348424/">Как работает JS: веб-воркеры и 5 сценариев их использования</a></li>
      <li><a href="https://developer.mozilla.org/ru/docs/Web/API/Web_Workers_API">Web Workers API</a></li>
      <li><a href="https://www.youtube.com/watch?v=pMK-jcOAYI8">Javascript web workers tutorial</a></li>
      <li><a href="http://www.wisdomweb.ru/HTML5/webworker.php">Знакомство с web worker</a></li>
      <li><a href="https://www.fullstackreact.com/articles/introduction-to-web-workers-with-react/">A Guide to using Web Workers in React</a></li>
    </ol>
  </section>

  <section class="slide">
    <a href="https://twitter.com/Chugainovkirill" class="place" style="font-size: 60px;">@Chugainovkirill</a>
  </section>
  
  <section class="slide">
    <h2 class="shout">Спасибо за внимание!</h2>
  </section>

  <section class="slide">
    <h2 class="shout">Вопросы?</h2>
  </section>
  
  <div class="progress"></div>

  <script src="shower/shower.min.js"></script>
  <!-- Copyright © 2018 Yours Truly, Famous Inc. -->

</body>

</html>